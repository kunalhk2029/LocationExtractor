services:
  - type: web
    name: reel-locator
    env: python
    plan: free
    buildCommand: "mkdir -p /tmp/apt/lists/partial /tmp/apt/cache && apt-get -o Dir::State::lists=/tmp/apt/lists update && apt-get -o Dir::Cache::archives=/tmp/apt/cache install -y ffmpeg && pip install -r requirements.txt && python manage.py collectstatic --noinput"
    startCommand: "python manage.py migrate && gunicorn reel_locator.wsgi:application --bind 0.0.0.0:$PORT"
    envVars:
      - key: DJANGO_SECRET_KEY
        generateValue: true
      - key: DJANGO_DEBUG
        value: "0"
      - key: DJANGO_ALLOWED_HOSTS
        value: ".onrender.com"
      - key: DJANGO_SERVE_MEDIA
        value: "1"
